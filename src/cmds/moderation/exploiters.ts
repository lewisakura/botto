import { CommandContext } from '../../types';

async function exec(ctx: CommandContext) {
    let message = '**Known exploiters:**\n\n';

    for (const member of ctx.msg.channel.guild.members.filter(m => m.roles.includes(ctx.config.exploiterRole))) {
        const userInfo = await ctx.db.user.findUnique({ where: { id: member.id } });
        message += `${member.mention} - ${member.username}#${member.discriminator} (\`${member.id}\`) (${
            userInfo ? userInfo.hungerGamesWins : 0
        } wins)\n`;
    }

    return ctx.reply({
        content: message,
        allowedMentions: {
            users: true
        }
    });
}

export default {
    name: 'exploiters',
    description: 'Gets a list of known exploiters.',

    exec,
    level: 2
};
